# ContentForge: 내가 다르게 구성한다면

현재 구조는 이미 모듈화가 잘 되어 있고(`packages/*`, `infra`, `docs`) 확장성을 고려한 설계입니다.
다만 운영/개발 속도를 더 높이기 위해, 나는 아래 6가지를 다르게 가져가겠습니다.

## 1) `docs`를 의사결정과 실행 문서로 분리
지금은 `docs/`에 아키텍처, 플랜, 브랜드, 포맷 문서가 함께 있어 빠르게 커질수록 탐색 비용이 증가합니다.

내 방식:
- `docs/adr/`: 의사결정(ADR)만 보관
- `docs/runbook/`: 운영 절차(배포, 장애 대응, 롤백)
- `docs/spec/`: 제품/파이프라인 스펙
- `docs/guide/`: 온보딩, 개발 가이드

이점:
- 신규 참여자가 "정책"과 "실행" 문서를 혼동하지 않음
- 변경 영향도 추적이 쉬워짐

## 2) `packages/agents`를 역할별 하위 모듈로 세분화
현재는 에이전트 파일들이 한 레벨에 함께 있어, 수가 늘수록 경계가 흐려질 가능성이 있습니다.

내 방식:
- `packages/agents/src/runtime/` (queue, lock, base)
- `packages/agents/src/roles/` (writer, strategist, guardian ...)
- `packages/agents/src/contracts/` (task/result DTO)
- `packages/agents/src/policies/` (채널 제한, 검증 규칙)

이점:
- "실행 인프라"와 "비즈니스 역할" 경계를 강제
- 테스트 스코프 분리(런타임 테스트 vs 역할 테스트)

## 3) 채널 규칙을 코드 상수에서 데이터 파일로 이관
현재 일부 채널 정책이 에이전트 코드 내부 상수에 위치합니다.

내 방식:
- `packages/core/config/channels/*.yaml` 또는 `json`
- 코드에서는 해당 스펙을 로드하고 검증만 수행

이점:
- 코드 배포 없이 채널 정책 수정 가능
- 운영자/기획자 협업이 쉬움(문서-코드 불일치 감소)

## 4) `video`와 `web` 사이에 공유 스키마 패키지 추가
영상 파이프라인 특성상 `video`(렌더링)와 `web`(에디터) 간 계약이 자주 깨질 수 있습니다.

내 방식:
- `packages/video-contracts/` 신설
- 씬 스키마(Zod), 버전 규약, 마이그레이션 유틸 공통화

이점:
- 프론트/백엔드/렌더러 간 타입 드리프트 방지
- 포맷 버전 업 시 하위 호환 전략 수립 용이

## 5) 테스트 구조를 "단위/계약/통합"으로 명시 분리
현재는 패키지별 테스트가 정돈되어 있지만, 성장 시 테스트 의도가 섞이기 쉽습니다.

내 방식:
- `src/__tests__/unit/*`
- `src/__tests__/contract/*`
- `tests/integration/*` (워크스페이스 루트)

이점:
- 실패 원인 파악 속도 향상
- CI에서 단계별 실행 전략 수립 가능(빠른 단위 -> 계약 -> 통합)

## 6) 실행 경로를 CLI 중심에서 "orchestrator" 중심으로 전환
현재 `packages/cli`가 전체를 조립하는 진입점 역할을 합니다.

내 방식:
- `packages/orchestrator/`를 별도 두고, CLI는 얇은 wrapper로 유지
- 스케줄러/큐 워커/백필 작업도 같은 orchestrator 재사용

이점:
- 수동 실행(CLI)과 자동 실행(크론/워크커) 로직 중복 제거
- 운영 시나리오 확장(재처리, 부분 재실행, 멱등성 제어) 쉬움

---

## 정리
현재 구조는 "좋은 베이스"입니다.
내가 다르게 하는 핵심은 **문서/정책/실행 로직의 경계를 더 강하게 분리해서, 운영 변경을 코드 변경과 최대한 분리**하는 것입니다.
